<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>도커 스웜 - Always Learning</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Always Learning"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Always Learning"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="도커 스웜을 사용하는 이유하나의 호스트 머신에서 도커 엔진을 구동하다, CPU, 메모리, 디스크 용량과 같은 자원이 부족해질 수 있다.이를 해결하기 위한 방법으로, 가장 많이 사용하는 방법이 여러 대의 서버를 클러스터로 만들어 자원을 병렬로 확장하는 것이다. 그러나, 여러 대의 서버를 하나의 자원 풀로 만드는 것은 쉽지 않다.에를 들면,  새로운 서버나 컨"><meta property="og:type" content="blog"><meta property="og:title" content="도커 스웜"><meta property="og:url" content="https://junhee-ko.github.io/2020/12/06/docker-swarm/"><meta property="og:site_name" content="Always Learning"><meta property="og:description" content="도커 스웜을 사용하는 이유하나의 호스트 머신에서 도커 엔진을 구동하다, CPU, 메모리, 디스크 용량과 같은 자원이 부족해질 수 있다.이를 해결하기 위한 방법으로, 가장 많이 사용하는 방법이 여러 대의 서버를 클러스터로 만들어 자원을 병렬로 확장하는 것이다. 그러나, 여러 대의 서버를 하나의 자원 풀로 만드는 것은 쉽지 않다.에를 들면,  새로운 서버나 컨"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://junhee-ko.github.io/img/og_image.png"><meta property="article:published_time" content="2020-12-05T15:00:00.000Z"><meta property="article:modified_time" content="2023-04-09T08:17:09.554Z"><meta property="article:author" content="junhee.ko"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://junhee-ko.github.io/2020/12/06/docker-swarm/"},"headline":"도커 스웜","image":["https://junhee-ko.github.io/img/og_image.png"],"datePublished":"2020-12-05T15:00:00.000Z","dateModified":"2023-04-09T08:17:09.554Z","author":{"@type":"Person","name":"junhee.ko"},"publisher":{"@type":"Organization","name":"Always Learning","logo":{"@type":"ImageObject","url":"https://junhee-ko.github.io/img/logo.svg"}},"description":"도커 스웜을 사용하는 이유하나의 호스트 머신에서 도커 엔진을 구동하다, CPU, 메모리, 디스크 용량과 같은 자원이 부족해질 수 있다.이를 해결하기 위한 방법으로, 가장 많이 사용하는 방법이 여러 대의 서버를 클러스터로 만들어 자원을 병렬로 확장하는 것이다. 그러나, 여러 대의 서버를 하나의 자원 풀로 만드는 것은 쉽지 않다.에를 들면,  새로운 서버나 컨"}</script><link rel="canonical" href="https://junhee-ko.github.io/2020/12/06/docker-swarm/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Always Learning" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-05T15:00:00.000Z" title="12/6/2020, 12:00:00 AM">2020-12-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-04-09T08:17:09.554Z" title="4/9/2023, 5:17:09 PM">2023-04-09</time></span><span class="level-item"><a class="link-muted" href="/categories/container/">Container</a></span></div></div><h1 class="title is-3 is-size-4-mobile">도커 스웜</h1><div class="content"><h2 id="도커-스웜을-사용하는-이유"><a href="#도커-스웜을-사용하는-이유" class="headerlink" title="도커 스웜을 사용하는 이유"></a>도커 스웜을 사용하는 이유</h2><p>하나의 호스트 머신에서 도커 엔진을 구동하다, CPU, 메모리, 디스크 용량과 같은 자원이 부족해질 수 있다.<br>이를 해결하기 위한 방법으로, 가장 많이 사용하는 방법이 여러 대의 서버를 클러스터로 만들어 자원을 병렬로 확장하는 것이다.</p>
<p>그러나, 여러 대의 서버를 하나의 자원 풀로 만드는 것은 쉽지 않다.<br>에를 들면,</p>
<ul>
<li>새로운 서버나 컨테이너가 추가되었을 때 이를 발견 하는 작업 (Service Discovery)</li>
<li>어떤 서버에 컨테이너를 할당할 것인가에 대한 스케쥴러</li>
<li>클러스터 내의 서버가 다운 되었을 때 고가용성 보장</li>
</ul>
<p>이러한 문제를 쉽게 해결할 수 있는 솔루션으로 도커에서 공식적으로 제공하는 Docker Swarm 과 Swarm Mode 를 사용할 수 있다.</p>
<h2 id="스웜-클래식과-도커-스웜-모드"><a href="#스웜-클래식과-도커-스웜-모드" class="headerlink" title="스웜 클래식과 도커 스웜 모드"></a>스웜 클래식과 도커 스웜 모드</h2><p>도커 스웜에는 두 가지 종류가 있다.</p>
<ol>
<li>스웜 크래식: 도커 버젼 1.6 이후부터 사용할 수 있는 컨테이너로서의 스웜</li>
<li>스웜 모드: 도커 버젼 1.2 이후부터 사용할 수 있는 도크 스웜 모드</li>
</ol>
<p>위 둘의 차이는, 목적이다.</p>
<ol>
<li>스웜 클래식: 여러 대의 도커 서버를 하나의 지점에서 사용하도록 단일 접근점을 제공한다.</li>
<li>스웜 모드: 마이크로서비스 아키텍처의 컨테이너를 다루기 위한 클러스터링 기능에 초점을 둔다.</li>
</ol>
<p>또 다른 차이로 분산 코디네이터, 에이전트와 같은 클러스터 툴이 별도로 구도되느냐이다.<br>여러 도커 서버를 하나의 클러스터로 구성하려면, 각종 정보를 저장하고 동기화하는 분산 코디네이터, 클러스터 내의 서버를 관리하고 제어하는 메니저, 각 서버를 제어하는 에이전트가 필요하다.</p>
<ol>
<li>스웜 클래식: 이들이 별도로 실행되야아한다.</li>
<li>스웜 모드: 도커 엔진 자체에 내장되어 있다.</li>
</ol>
<p>대규모 클러스터에서 서비스를 운영한다면, 스웜 클래식보다 스웜 모드를 사용하자.<br>스웜 모드를 사용한다면 더 많은 기능을 쉽게 사용할 수 있다.<br>또한, 스웜 클래식은 도커 공식 문서에서도 legacy 로 언급하며 유지 보수가 활발하지 않다.</p>
<h2 id="도커-스웜모드의-구조"><a href="#도커-스웜모드의-구조" class="headerlink" title="도커 스웜모드의 구조"></a>도커 스웜모드의 구조</h2><p>스웜 모드는 메니저 노드와 워커 노드로 구성되어 있다.<br>워커 노드는 실제로 컨테이너가 생성되고 관리되는 도커 서버이고, 메니저 노드는 워커 노드를 관리하기 위한 도커 서버이다.</p>
<p>운영 환경에서는, 메니저 노드를 다중화하자.<br>메니저의 부하를 분산하고, 특정 메니저 노드가 다운되었을 때 정상적으로 스웜 클러스터를 유지할 수 있기 때문이다.</p>
<h2 id="스웜-모드-서비스"><a href="#스웜-모드-서비스" class="headerlink" title="스웜 모드 서비스"></a>스웜 모드 서비스</h2><p>도커 명령어의 제어 단위는 컨테이너이다.<br>docker run 명령어는 컨테이너를 생성하고 docker rm 명령어는 컨테이너를 삭제한다.</p>
<p>스웜 모드에서 제어하느 단위는, Service 이다.<br>서비스는 같은 이미지에서 생성된 컨테이너의 집합이다.<br>서비스를 제어하면, 해당 서비스 내의 컨테이너에 같은 명령어가 수행된다.<br>서비스 내 컨테이너는 한 개 이상 존재할 수 있으며, 컨테이너들은 각 워커 노드와 메니저 노드에 할당된다.<br>이러한 컨테이너들을 Task 라고 부른다.</p>
<p>함께 생성된 컨테이너는 Replica 라고 한다.<br>서비스에 설정된 레플리카의 수 만큼 컨테이너가 스웜 클러스터 내에 존재해야한다.<br>스웜은 서비스의 컨테이너들에 대한 상태를 계속 확인하고 서비스 내에 정의된 레플리카의 수 만큼, 컨테이너가 스웜 클러스터 내에 존재하지 않으면, 새로운 컨테이너 레플리카를 생성한다.</p>
<hr>
<p>시작하세요! 도커/쿠버네티스 &lt;용찬호&gt;</p>
</div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/12/08/docker-compose/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">도커 컴포즈</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/12/05/docker-engine/"><span class="level-item">도커 엔진</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'https://junhee-ko.github.io/2020/12/06/docker-swarm/';
            this.page.identifier = '2020/12/06/docker-swarm/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'junhee-ko' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><p class="title is-size-4 is-block" style="line-height:inherit;">Junhee Ko</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">373</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/junhee-ko" target="_blank" rel="noopener">Follow</a></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-18T15:00:00.000Z">2023-03-19</time></p><p class="title"><a href="/2023/03/19/clean-software-state-pattern/">State Pattern</a></p><p class="categories"><a href="/categories/agile/">Agile</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-17T15:00:00.000Z">2023-03-18</time></p><p class="title"><a href="/2023/03/18/clean-software-abstractserver-adapter-pattern/">Abstract Server, Adapter Pattern</a></p><p class="categories"><a href="/categories/agile/">Agile</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-10T15:00:00.000Z">2023-03-11</time></p><p class="title"><a href="/2023/03/11/clean-software-composite-pattern/">Composite Pattern</a></p><p class="categories"><a href="/categories/agile/">Agile</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-09T15:00:00.000Z">2023-03-10</time></p><p class="title"><a href="/2023/03/10/clean-software-factory-pattern/">Factory Pattern</a></p><p class="categories"><a href="/categories/agile/">Agile</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-08T15:00:00.000Z">2023-03-09</time></p><p class="title"><a href="/2023/03/09/clean-software-principles-of-package-design/">Principles of Package Design</a></p><p class="categories"><a href="/categories/agile/">Agile</a></p></div></article></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/agile/"><span class="level-start"><span class="level-item">Agile</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/algorithm/"><span class="level-start"><span class="level-item">Algorithm</span></span><span class="level-end"><span class="level-item tag">180</span></span></a></li><li><a class="level is-mobile" href="/categories/architecture/"><span class="level-start"><span class="level-item">Architecture</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/big-data/"><span class="level-start"><span class="level-item">Big Data</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/clean-code/"><span class="level-start"><span class="level-item">Clean Code</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/container/"><span class="level-start"><span class="level-item">Container</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/graphql/"><span class="level-start"><span class="level-item">GraphQL</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/implementation-patterns/"><span class="level-start"><span class="level-item">Implementation Patterns</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/jpa/"><span class="level-start"><span class="level-item">JPA</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/kafka/"><span class="level-start"><span class="level-item">Kafka</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/kotlin/"><span class="level-start"><span class="level-item">Kotlin</span></span><span class="level-end"><span class="level-item tag">23</span></span></a></li><li><a class="level is-mobile" href="/categories/oauth/"><span class="level-start"><span class="level-item">OAuth</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/oop/"><span class="level-start"><span class="level-item">OOP</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/os/"><span class="level-start"><span class="level-item">OS</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/categories/reactor/"><span class="level-start"><span class="level-item">Reactor</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/redis/"><span class="level-start"><span class="level-item">Redis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/refactoring/"><span class="level-start"><span class="level-item">Refactoring</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/tdd/"><span class="level-start"><span class="level-item">TDD</span></span><span class="level-end"><span class="level-item tag">32</span></span></a></li><li><a class="level is-mobile" href="/categories/test-code/"><span class="level-start"><span class="level-item">Test Code</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/grpc/"><span class="level-start"><span class="level-item">gRPC</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Always Learning" height="28"></a><p class="is-size-7"><span>&copy; 2023 junhee.ko</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>